<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Trang quản trị - Decora Admin</title>
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="../css/style.css" rel="stylesheet">
  <link href="../css/admin.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="admin-wrapper">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <h2>Decora<span>.</span> Admin</h2>
      </div>
      <nav class="sidebar-nav">
        <ul class="nav-menu">
          <li class="nav-item active" data-page="home">
            <a href="#" class="nav-link">
              <i class="fas fa-home"></i>
              <span>Trang chủ</span>
            </a>
          </li>
          <li class="nav-item" data-page="users">
            <a href="#" class="nav-link">
              <i class="fas fa-users"></i>
              <span>Quản lý người dùng</span>
            </a>
          </li>
          <li class="nav-item" data-page="products">
            <a href="#" class="nav-link">
              <i class="fas fa-box"></i>
              <span>Quản lý sản phẩm</span>
            </a>
          </li>
          <li class="nav-item" data-page="categories">
            <a href="#" class="nav-link">
              <i class="fas fa-tags"></i>
              <span>Quản lý danh mục</span>
            </a>
          </li>
          <li class="nav-item" data-page="orders">
            <a href="#" class="nav-link">
              <i class="fas fa-receipt"></i>
              <span>Quản lý đơn hàng</span>
            </a>
          </li>
          <li class="nav-item" data-page="forum">
            <a href="#" class="nav-link">
              <i class="fas fa-comments"></i>
              <span>Quản lý bài viết</span>
            </a>
          </li>
          <li class="nav-item" data-page="shippers">
            <a href="#" class="nav-link">
              <i class="fas fa-truck"></i>
              <span>Quản lý shipper</span>
            </a>
          </li>
          <li class="nav-item" data-page="promotions">
            <a href="#" class="nav-link">
              <i class="fas fa-percent"></i>
              <span>Quản lý khuyến mãi</span>
            </a>
          </li>
        </ul>
      </nav>
      <div class="sidebar-footer">
        <a href="index.html" class="btn btn-outline-light btn-sm">
          <i class="fas fa-arrow-left"></i> Về trang chủ
        </a>
        <button id="logout-btn" class="btn btn-danger btn-sm mt-2">
          <i class="fas fa-sign-out-alt"></i> Đăng xuất
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="admin-content">
      <header class="admin-header">
        <h1 id="page-title">Trang chủ</h1>
        <div class="user-info">
          <span id="admin-name"></span>
        </div>
      </header>

      <!-- Home Page -->
      <div id="page-home" class="page-content active">
        <section class="home-hero card mb-4">
          <div class="card-body">
            <p class="eyebrow text-uppercase text-muted mb-2">Bảng điều khiển</p>
            <h2 class="mb-2">Trung tâm phân tích doanh thu</h2>
            <p class="text-muted mb-0">
              Giám sát hiệu suất bán hàng, hành vi thanh toán và tình trạng đơn hàng ở một nơi duy nhất để đưa ra quyết định nhanh chóng.
            </p>
          </div>
        </section>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon" style="background: #3b5d50;">
              <i class="fas fa-sack-dollar"></i>
            </div>
            <div class="stat-info">
              <h3 id="total-revenue">0đ</h3>
              <p>Tổng doanh thu toàn hệ thống</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: #f9bf29;">
              <i class="fas fa-clipboard-list"></i>
            </div>
            <div class="stat-info">
              <h3 id="total-orders">0</h3>
              <p>Số đơn hàng đã ghi nhận</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: #16a34a;">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="stat-info">
              <h3 id="today-revenue">0đ</h3>
              <p>Doanh thu phát sinh trong ngày</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: #0ea5e9;">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-info">
              <h3 id="month-revenue">0đ</h3>
              <p>Doanh thu tháng hiện tại</p>
              <p class="stat-note">Số đơn: <span id="month-orders">0 đơn</span></p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: #dc2626;">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-info">
              <h3 id="year-revenue">0đ</h3>
              <p>Doanh thu lũy kế trong năm</p>
              <p class="stat-note">Số đơn: <span id="year-orders">0 đơn</span></p>
            </div>
          </div>
        </div>

        <div class="charts-grid">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Doanh thu 7 ngày gần nhất</h3>
            </div>
            <canvas id="revenueChart"></canvas>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <h3>Tỷ trọng phương thức thanh toán</h3>
            </div>
            <canvas id="paymentMethodChart"></canvas>
          </div>
        </div>

        <div class="charts-grid">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Doanh thu theo tháng (năm hiện tại)</h3>
            </div>
            <canvas id="monthlyRevenueChart"></canvas>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <h3>Top 5 khách hàng chi tiêu</h3>
            </div>
            <div id="top-customers-list"></div>
          </div>
        </div>

        <section class="revenue-workbench">
          <div class="section-heading">
            <div>
              <h2>Thao tác nhanh các thống kê doanh thu</h2>
              <span>Thiết lập điều kiện lọc và xem ngay bảng số liệu cập nhật.</span>
            </div>
            <div class="workbench-actions">
              <button class="btn btn-sm btn-outline-light" id="refresh-revenue-widgets">
                <i class="fas fa-rotate"></i> Đặt lại tham số mặc định
              </button>
            </div>
          </div>
          <div class="revenue-panels">
            <article class="revenue-panel">
              <header>
                <div>
                  <h3>Thống kê theo ngày</h3>
                  <p class="panel-description">Phân tích nhanh doanh thu trong một ngày cụ thể.</p>
                </div>
                <span class="badge badge-soft badge-primary">Daily</span>
              </header>
              <div class="panel-body">
                <div class="panel-controls">
                  <label for="revenue-day-input" class="form-label">Ngày cần xem</label>
                  <input type="date" id="revenue-day-input" class="form-control">
                </div>
                <div class="panel-actions">
                  <button class="btn btn-primary" id="revenue-day-btn"><i class="fas fa-search"></i> Xem thống kê</button>
                </div>
                <div class="panel-result" id="revenue-day-result">
                  <p class="text-muted small mb-0">Chọn ngày để xem thống kê.</p>
                </div>
              </div>
            </article>
            <article class="revenue-panel">
              <header>
                <div>
                  <h3>Thống kê theo tháng</h3>
                  <p class="panel-description">So sánh tổng doanh thu từng ngày trong một tháng.</p>
                </div>
                <span class="badge badge-soft badge-warning">Monthly</span>
              </header>
              <div class="panel-body">
                <div class="panel-controls two-columns">
                  <select id="revenue-month-select" class="form-select">
                    <option value="">Chọn tháng</option>
                    <option value="1">Tháng 1</option>
                    <option value="2">Tháng 2</option>
                    <option value="3">Tháng 3</option>
                    <option value="4">Tháng 4</option>
                    <option value="5">Tháng 5</option>
                    <option value="6">Tháng 6</option>
                    <option value="7">Tháng 7</option>
                    <option value="8">Tháng 8</option>
                    <option value="9">Tháng 9</option>
                    <option value="10">Tháng 10</option>
                    <option value="11">Tháng 11</option>
                    <option value="12">Tháng 12</option>
                  </select>
                  <input type="number" id="revenue-month-year" class="form-control" placeholder="Năm">
                </div>
                <div class="panel-actions">
                  <button class="btn btn-primary" id="revenue-month-btn"><i class="fas fa-chart-column"></i> Xem báo cáo</button>
                </div>
                <div class="panel-result" id="revenue-month-result">
                  <p class="text-muted small mb-0">Chọn tháng / năm để hiển thị.</p>
                </div>
              </div>
            </article>
            <article class="revenue-panel">
              <header>
                <div>
                  <h3>Thống kê theo năm</h3>
                  <p class="panel-description">Xem hiệu suất theo từng tháng trong năm.</p>
                </div>
                <span class="badge badge-soft badge-success">Yearly</span>
              </header>
              <div class="panel-body">
                <div class="panel-controls">
                  <label for="revenue-year-input" class="form-label">Năm cần xem</label>
                  <input type="number" id="revenue-year-input" class="form-control" placeholder="Ví dụ: 2025">
                </div>
                <div class="panel-actions">
                  <button class="btn btn-primary" id="revenue-year-btn"><i class="fas fa-chart-line"></i> Phân tích</button>
                </div>
                <div class="panel-result" id="revenue-year-result">
                  <p class="text-muted small mb-0">Nhập năm để xem báo cáo.</p>
                </div>
              </div>
            </article>
            <article class="revenue-panel">
              <header>
                <div>
                  <h3>Khoảng thời gian tùy chỉnh</h3>
                  <p class="panel-description">Kết hợp nhiều ngày để đo doanh thu trung bình.</p>
                </div>
                <span class="badge badge-soft badge-danger">Range</span>
              </header>
              <div class="panel-body">
                <div class="panel-controls two-columns">
                  <input type="date" id="revenue-range-from" class="form-control">
                  <input type="date" id="revenue-range-to" class="form-control">
                </div>
                <div class="panel-actions">
                  <button class="btn btn-primary" id="revenue-range-btn"><i class="fas fa-sliders-h"></i> Áp dụng bộ lọc</button>
                </div>
                <div class="panel-result" id="revenue-range-result">
                  <p class="text-muted small mb-0">Chọn khoảng thời gian để xem biểu đồ.</p>
                </div>
              </div>
            </article>
          </div>
        </section>

        <section class="order-status-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Trạng thái đơn hàng & công nợ</h3>
            </div>
            <canvas id="orderStatusChart"></canvas>
          </div>
          <div class="table-container compact">
            <h4 class="mb-3">Tóm tắt trạng thái</h4>
            <div id="order-status-summary" class="summary-list"></div>
          </div>
        </section>
      </div>

      <!-- Users Management Page -->
      <div id="page-users" class="page-content">
        <div class="page-header">
          <h2>Quản lý người dùng</h2>
          <button class="btn btn-primary" id="add-user-btn">
            <i class="fas fa-plus"></i> Thêm người dùng
          </button>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Họ tên</th>
                <th>Email</th>
                <th>Số điện thoại</th>
                <th>Địa chỉ</th>
                <th>Admin</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="users-table-body">
              <!-- Users will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Products Management Page -->
      <div id="page-products" class="page-content">
        <div class="page-header">
          <h2>Quản lý sản phẩm</h2>
          <button class="btn btn-primary" id="add-product-btn">
            <i class="fas fa-plus"></i> Thêm sản phẩm
          </button>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Hình ảnh</th>
                <th>Tên sản phẩm</th>
                <th>Giá</th>
                <th>Số lượng</th>
                <th>Danh mục</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="products-table-body">
              <!-- Products will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Categories Management Page -->
      <div id="page-categories" class="page-content">
        <div class="page-header">
          <h2>Quản lý danh mục</h2>
          <button class="btn btn-primary" id="add-category-btn">
            <i class="fas fa-plus"></i> Thêm danh mục
          </button>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tên danh mục</th>
                <th>Mô tả</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="categories-table-body">
              <!-- Categories will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Orders Management Page -->
      <div id="page-orders" class="page-content">
        <div class="page-header">
          <h2>Quản lý đơn hàng</h2>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Khách hàng</th>
                <th>Ngày tạo</th>
                <th>Số sản phẩm</th>
                <th>Tổng giá trị</th>
                <th>Trạng thái</th>
                <th>Shipper</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="orders-table-body">
              <!-- Orders will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Shippers Management Page -->
      <div id="page-shippers" class="page-content">
        <div class="page-header">
          <h2>Quản lý shipper</h2>
          <button class="btn btn-primary" id="add-shipper-btn">
            <i class="fas fa-plus"></i> Thêm shipper
          </button>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tên shipper</th>
                <th>Số điện thoại</th>
                <th>Email</th>
                <th>Trạng thái</th>
                <th>Số đơn hàng</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="shippers-table-body">
              <!-- Shippers will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Forum Posts Management Page -->
      <div id="page-forum" class="page-content">
        <div class="page-header">
          <h2>Quản lý bài viết diễn đàn</h2>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tiêu đề</th>
                <th>Tác giả</th>
                <th>Ngày tạo</th>
                <th>Lượt xem</th>
                <th>Số bình luận</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="forum-posts-admin-body">
              <!-- Forum posts will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Forum Post Modal (Admin edit) -->
      <div id="forum-edit-modal" class="modal">
        <div class="modal-content" style="max-width: 640px;">
          <span class="close" onclick="closeForumEditModal()">&times;</span>
          <h3 id="forum-edit-modal-title" class="mb-3">Sửa bài viết</h3>
          <form id="forum-edit-form">
            <input type="hidden" id="forum-edit-id">
            <div class="form-group">
              <label for="forum-edit-title">Tiêu đề *</label>
              <input type="text" id="forum-edit-title" class="form-control" required maxlength="150">
            </div>
            <div class="form-group">
              <label for="forum-edit-content">Nội dung *</label>
              <textarea id="forum-edit-content" class="form-control" rows="6" required maxlength="5000"></textarea>
            </div>
            <div class="form-actions">
              <button type="button" class="btn btn-secondary" onclick="closeForumEditModal()">Hủy</button>
              <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Promotions Management Page -->
      <div id="page-promotions" class="page-content">
        <div class="page-header">
          <h2>Quản lý khuyến mãi</h2>
          <button class="btn btn-primary" id="add-promotion-btn">
            <i class="fas fa-plus"></i> Thêm khuyến mãi
          </button>
        </div>
        <div class="table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tên khuyến mãi</th>
                <th>Mô tả</th>
                <th>% Giảm</th>
                <th>Ngày bắt đầu</th>
                <th>Ngày kết thúc</th>
                <th>Trạng thái</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody id="promotions-table-body">
              <!-- Promotions will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Modals -->
  <!-- User Modal -->
  <div id="user-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="user-modal-title">Thêm người dùng</h2>
      <form id="user-form">
        <input type="hidden" id="user-id">
        <div class="form-group">
          <label>Họ tên *</label>
          <input type="text" id="user-hoTen" required>
        </div>
        <div class="form-group">
          <label>Email *</label>
          <input type="email" id="user-email" required>
        </div>
        <div class="form-group">
          <label>Số điện thoại</label>
          <input type="text" id="user-sdt">
        </div>
        <div class="form-group">
          <label>Địa chỉ</label>
          <input type="text" id="user-diaChi">
        </div>
        <div class="form-group">
          <label>Mật khẩu <span id="user-password-note">*</span></label>
          <input type="password" id="user-matKhau">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="user-isAdmin"> Quyền quản trị viên
          </label>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeModal('user-modal')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Product Modal -->
  <div id="product-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="product-modal-title">Thêm sản phẩm</h2>
      <form id="product-form" enctype="multipart/form-data">
        <input type="hidden" id="product-id">
        <div class="form-group">
          <label>Tên sản phẩm *</label>
          <input type="text" id="product-tenSp" required>
        </div>
        <div class="form-group">
          <label>Mô tả</label>
          <textarea id="product-moTa" rows="3"></textarea>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Giá *</label>
            <input type="number" id="product-gia" step="0.01" required>
          </div>
          <div class="form-group">
            <label>Số lượng *</label>
            <input type="number" id="product-soLuong" required>
          </div>
        </div>
        <div class="form-group">
          <label>Danh mục *</label>
          <select id="product-categoryId" required>
            <option value="">Chọn danh mục</option>
          </select>
        </div>
        <div class="form-group">
          <label>Hình ảnh</label>
          <input type="file" id="product-images" multiple accept="image/*">
          <div id="product-images-preview"></div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeModal('product-modal')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Category Modal -->
  <div id="category-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="category-modal-title">Thêm danh mục</h2>
      <form id="category-form">
        <input type="hidden" id="category-id">
        <div class="form-group">
          <label>Tên danh mục *</label>
          <input type="text" id="category-tenDanhMuc" required>
        </div>
        <div class="form-group">
          <label>Mô tả</label>
          <textarea id="category-moTa" rows="3"></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeModal('category-modal')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Promotion Modal -->
  <div id="promotion-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="promotion-modal-title">Thêm khuyến mãi</h2>
      <form id="promotion-form">
        <input type="hidden" id="promotion-id">
        <div class="form-group">
          <label>Tên khuyến mãi *</label>
          <input type="text" id="promotion-tenKhuyenMai" required>
        </div>
        <div class="form-group">
          <label>Mô tả</label>
          <textarea id="promotion-moTa" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label>Phần trăm giảm (%) *</label>
          <input type="number" id="promotion-phanTramGiam" min="1" max="100" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Ngày bắt đầu *</label>
            <input type="date" id="promotion-ngayBatDau" required>
          </div>
          <div class="form-group">
            <label>Ngày kết thúc *</label>
            <input type="date" id="promotion-ngayKetThuc" required>
          </div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeModal('promotion-modal')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Shipper Modal -->
  <div id="shipper-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="shipper-modal-title">Thêm shipper</h2>
      <form id="shipper-form">
        <input type="hidden" id="shipper-id">
        <div class="form-group">
          <label>Tên shipper *</label>
          <input type="text" id="shipper-tenShipper" required>
        </div>
        <div class="form-group">
          <label>Điện thoại *</label>
          <input type="text" id="shipper-dienThoai" required>
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="shipper-email">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="shipper-trangThai" checked> Đang hoạt động
          </label>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeModal('shipper-modal')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.8/dist/axios.min.js"></script>
  <script type="module" src="../js/admin.js"></script>
  <script src="../js/bootstrap.bundle.min.js"></script>
</body>
</html>

